<script>

    document.addEventListener("DOMContentLoaded",function(){

        google.script.run.withSuccessHandler(generateTable).getOpportunitiesData();

    });

    document.addEventListener('DOMContentLoaded', function() {
        var elems = document.querySelectorAll('select');
        var instances = M.FormSelect.init(elems);
    });


    function generateTable(dataArray){

        var tbody = document.getElementById("table-body");

        dataArray.forEach(function(r){

            var row = document.createElement("tr");
            var col1 = document.createElement("td");
            col1.textContent = r[0];
            var col2 = document.createElement("td");

            var myDate = new Date(r[1]);
            col2.textContent = myDate.toDateString();

            var col3 = document.createElement("td");
            col3.textContent = r[2];
            var col4 = document.createElement("td");
            col4.textContent = r[3];
            var col5 = document.createElement("td");
            col5.textContent = r[4];
            var col6 = document.createElement("td");
            col6.textContent = r[5];
            var col7 = document.createElement("td");
            col7.textContent = r[6];
            var col8 = document.createElement("td");
            col8.textContent = r[7];
            var col9 = document.createElement("td");
            col9.textContent = r[8];
            var col11 = document.createElement("td");
            var myDate2 = new Date(r[14]);
            col11.textContent = myDate.toDateString();

            row.appendChild(col1);
            row.appendChild(col2);
            row.appendChild(col3);
            row.appendChild(col4);
            row.appendChild(col5);
            row.appendChild(col6);
            row.appendChild(col7);
            row.appendChild(col8);
            row.appendChild(col9);
            row.appendChild(col11);


            tbody.appendChild(row);

        });

    }


</script>